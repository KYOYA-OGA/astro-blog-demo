---
import MainLayout from "@layouts/MainLayout.astro";
import Container from "@components/Container";
import PostCard from "@components/PostCard.astro";
import PostGrid from "@components/PostGrid";
import LinkButton from '@components/LinkButton';

export async function getStaticPaths({paginate}){
  const postPages = [
    { 'id':'1' ,'title': 'post1' },
    { 'id':'2' ,'title': 'post2' },
    { 'id':'3' ,'title': 'post3' },
    { 'id':'4' ,'title': 'post4' },
    { 'id':'5' ,'title': 'post5' },
    { "id":'6', 'title': 'post6' },
    { "id":'7', 'title': 'post7' },
  ]
  return paginate(postPages, {pageSize: 3});
}
const {page} = Astro.props;
const totalPageArray = new Array(page.size).fill('')

---

<MainLayout>
  <Container className="py-5 md:py-10">
    <PostGrid>
      {page.data.map(post=>{
        return <PostCard id={post.id} title={post.title} />
      })}
    </PostGrid>

    <div class="space-y-4 md:space-y-6">
      <p class="text-center">現在のページ：{page.currentPage} / {page.size}</p>

      <!--todo ページが増えた際に省略する -->
      <ul class="flex justify-center gap-x-3">
        {totalPageArray.map((_,index)=>{
          const pageNum = index + 1;
          return <li><a href={`/posts/${pageNum}`} class="bg-blue-500 px-3 py-2 rounded-full text-white">{pageNum}</a></li>
        })}
      </ul>

      <div class="flex justify-center items-center gap-x-5 md:gap-x-8">
        {page.url.prev ?
        <LinkButton href={page.url.prev}>新しい記事へ</LinkButton>: null}
        {page.url.next ? <LinkButton href={page.url.next}>古い記事へ</LinkButton> : null}
      </div>
    </div>

  </Container>
</MainLayout>


